uuid: e972ee9b-3705-4380-9fee-5d2a33e0d531
langcode: en
status: true
dependencies: {  }
id: digital_wires_wireq
class: null
field_plugin_method: null
cck_plugin_method: null
migration_tags: null
migration_group: dpa
label: 'Digital Wires Wireq API'
source:
  plugin: wireq_source
  track_changes: true
  data_fetcher_plugin: http
  data_parser_plugin: json
  item_selector: entries
  ids:
    urn:
      type: string
  fields:
    -
      name: urn
      selector: urn
    -
      name: wireq_receipt
      selector: _wireq_receipt
    -
      name: pubstatus
      selector: pubstatus
    -
      name: created
      selector: version_created
    -
      name: updated
      selector: updated
    -
      name: headline
      selector: headline
    -
      name: kicker
      selector: kicker
    -
      name: teaser
      selector: teaser
    -
      name: byline
      selector: byline
    -
      name: dateline
      selector: dateline
    -
      name: article_html
      selector: article_html
    -
      name: associations
      selector: associations
    -
      name: copyrightnotice
      selector: copyrightnotice
    -
      name: categories
      selector: categories
process:
  _title_prefix:
    -
      plugin: static_map
      source: pubstatus
      map:
        canceled: 'ACHTUNG! Zur√ºckgezogen! - '
      default_value: ''
  title:
    -
      plugin: concat
      source:
        - '@_title_prefix'
        - headline
  status:
    -
      plugin: static_map
      source: pubstatus
      map:
        canceled: 0
        usable: 1
  type:
    plugin: default_value
    default_value: dpa_meldung
  created:
    plugin: format_date_extended
    source: created
    from_format: 'Y-m-d\TH:i:se'
    to_format: U
  changed:
    plugin: format_date_extended
    source: updated
    from_format: 'Y-m-d\TH:i:s\Z'
    to_format: U
  field_byline: byline
  field_date_created:
    plugin: format_date_extended
    source: created
    from_format: 'Y-m-d\TH:i:se'
    to_format: 'Y-m-d\TH:i:s'
  field_copyright_notice: copyrightnotice
  field_dateline: dateline
  field_dpa_urn: urn
  field_headline: headline
  field_kicker: kicker
  field_teaser: teaser
  body/value: article_html
  body/format:
    plugin: default_value
    default_value: basic_html
  field_images:
    plugin: sub_process
    source: associations
    process:
      target_id:
        -
          plugin: extract
          source: renditions
          index:
            - 0
            - url
        -
          plugin: file_import
          destination: 'public://dpa_wireq_images/'
          skip_on_missing_source: TRUE
          id_only: TRUE
        -
          plugin: skip_on_empty
          method: process
        -
          plugin: media_generate
          destination_bundle: image
          destination_field: field_media_image
  field_rubrik:
    -
      plugin: get
      source: categories
    -
      plugin: dpa_filter_categories
      filter_type: 'dnltype:rubric'
    -
      plugin: entity_generate
      value_key: name
      bundle_key: vid
      bundle: dpa_rubrik
      entity_type: taxonomy_term
      ignore_case: true
destination:
  plugin: 'entity:node'
migration_dependencies: null
